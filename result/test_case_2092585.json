{
    "id": 2092585,
    "title": "ENG-424414 Verify DLP Alerts/incidents action as Content-scan-failure Action correctly",
    "section_id": 146022,
    "template_id": 1,
    "type_id": 6,
    "priority_id": 2,
    "milestone_id": null,
    "refs": null,
    "created_by": 339,
    "created_on": 1720041979,
    "updated_by": 729,
    "updated_on": 1738516720,
    "estimate": null,
    "estimate_forecast": null,
    "suite_id": 921,
    "display_order": 1,
    "is_deleted": 0,
    "case_assignedto_id": null,
    "custom_automation_type": 0,
    "custom_automatable": 1,
    "custom_automated": 1,
    "custom_deprecatedtestcase": false,
    "custom_ui_case": 1,
    "custom_automation_id": null,
    "custom_hack_functional_sub_categories": 1,
    "custom_hack_test_categories": 3,
    "custom_hack_jira_escalated": false,
    "custom_appliance_support": 2,
    "custom_sub_component": 1,
    "custom_testrail_bdd_scenario": null,
    "custom_summary": "Related bugs: https://netskope.atlassian.net/browse/ENG-424414, https://netskope.atlassian.net/browse/ENG-536773, https://netskope.atlassian.net/browse/ENG-421943",
    "custom_preconds": "This needs new feature flag \"accurate-dlp-failure-actions\" in feature_config.json turned on with R118 release build.",
    "custom_steps": "Enable tenant level feature flag: accurate-dlp-failure-actions\r\n\r\nSetup Content-scan-failure DLP Action as Block\r\n\r\nconfigure DLP policy with action as \u201cAlert\u201c\r\n\r\nRoute traffic cause DLP SCAN Timeout to introduce Content-scan-failure  Action",
    "custom_expected": "Verify DLP Alerts and Incidents show action as Content-scan-failure DLP Action upon DLP Scan timeout.\r\n\r\nhere are the complete list of scenarios:\r\n\r\nScan failure action = block, default action = block.  DLP says the activity is \"block\", proxy true action is \"block\", 1 event emitted.\r\n\r\nScan failure action = block, default action = alert.  DLP says the activity is \"block\", proxy true action is \"block\", 1 event emitted.\r\n\r\nScan failure action = block, default action = allow.  DLP says the activity is \"block\", proxy true action is \"block\", 1 event emitted.\r\n\r\nScan failure action = alert, default action = block.  DLP says the activity is \"block\", proxy true action is \"block\", 2 events emitted.\r\n\r\nScan failure action = alert, default action = alert.  DLP says the activity is \"alert\", proxy true action is \"alert\", 2 events emitted.\r\n\r\nScan failure action = alert, default action = allow.  DLP says the activity is \"alert\", proxy true action is \"allow\", 1 event emitted.\r\n\r\nScan failure action = allow, default action = block.  DLP says the activity is \"block\", proxy true action is \"block\", 1 event emitted.\r\n\r\nScan failure action = allow, default action = alert.  DLP says the activity is \"alert\", proxy true action is \"alert\", 1 event emitted.\r\n\r\nScan failure action = allow, default action = allow.  DLP says the activity is \"allow\", proxy true action is \"allow\", 0 events emitted.\r\n\r\nEach of these scenarios seem like the correct action for DLP to emit to me.  In particular this is our troublemaker:\r\n\r\n Scan failure action = alert, default action = allow.  DLP says the activity is \"alert\", proxy true action is \"allow\", 1 event emitted.\r\n\r\nThis is the only one where the DLP emit differs from the \"true final action\" that the proxy takes, but importantly, we are emitting an out-of-band event, so I think DLP describing the action as \"alert\" still accurately describes what the customer sees.\r\n\r\nAs per change in ENG-566639 in R123, Non fallback Alerts should not have content inspection failure details. SUCH AS , \r\ndlp fail reason: DLP Scan timeout\r\ndlp scan failed: yes",
    "custom_steps_separated": null,
    "custom_mission": null,
    "custom_goals": null,
    "comments": [],
    "custom_keyword": [],
    "custom_stack_label": [
        4
    ]
}