{
    "id": 2103270,
    "title": "ENG-457975 policy Alert and NSClient Block Template shows correct category based on terminal policy",
    "section_id": 146022,
    "template_id": 1,
    "type_id": 6,
    "priority_id": 2,
    "milestone_id": null,
    "refs": null,
    "created_by": 339,
    "created_on": 1722379381,
    "updated_by": 729,
    "updated_on": 1738516760,
    "estimate": null,
    "estimate_forecast": null,
    "suite_id": 921,
    "display_order": 2,
    "is_deleted": 0,
    "case_assignedto_id": null,
    "custom_automation_type": 0,
    "custom_automatable": 1,
    "custom_automated": 0,
    "custom_deprecatedtestcase": false,
    "custom_ui_case": 1,
    "custom_automation_id": null,
    "custom_hack_functional_sub_categories": 1,
    "custom_hack_test_categories": 3,
    "custom_hack_jira_escalated": false,
    "custom_appliance_support": 2,
    "custom_sub_component": 48,
    "custom_testrail_bdd_scenario": null,
    "custom_summary": "Policy Engine fetch all Categories that matches for a transaction and until no wit showed first matched/best efforts to show category from matched list, instead of terminal policy listed category. ENG-457975 introduced fix to show Category included in terminal policy instead of randomly picked category from all matched categories.",
    "custom_preconds": "Fix in R119",
    "custom_steps": "A policy rule may have multiple categories specified and a transaction might have several different categories associated with it.  In some cases the category included in the events was not one of the categories included in the policy rule that was matched.  If a RTP policy containing a category condition is matched then the events generated for the transaction should have a category ID that matches one of the categories specified in the policy.  This previously worked when content inspection was not required but not when file filter, TSS, or DLP inspection was needed.  This feature now works with content inspection so it needs to be tested with different combinations of inspection and non-inspection rules.  It would be best to include these test cases in the regression test suite.\r\n\r\nCases to test:\r\n\r\n* Match a non-inspection rule with a category\r\n* Match a non-inspection rule with no category condition (no override expected)\r\n* Match a file filter based rule with a category\r\n* Match a non-inspection rule with a category after a file filter based rule where the file condition does not match.\r\n* Match a TSS rule with a category\r\n* Match a non-inspection rule with a category after a TSS rule where no TSS profile match is found\r\n* Match a TSS rule that also includes a file filter condition and a category condition\r\n* Match a traffic action in a DLP rule that has a category condition\r\n* Define a DLP rule with a file filter condition and a category condition.  Make sure the file condition matches but the DLP profile does not.  Fallback to the default action (no override expected)",
    "custom_expected": "policy Alert and NSClient Block Template shows correct category based on terminal policy in each scenarios",
    "custom_steps_separated": null,
    "custom_mission": null,
    "custom_goals": null,
    "comments": [],
    "custom_keyword": [],
    "custom_stack_label": [
        4
    ]
}