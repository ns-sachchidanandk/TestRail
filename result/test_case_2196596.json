{
    "id": 2196596,
    "title": "Validate Primary nexthop back connection failure due to DNS; 2nd attempt with secondary nexthop back connnection",
    "section_id": 142819,
    "template_id": 1,
    "type_id": 6,
    "priority_id": 3,
    "milestone_id": null,
    "refs": null,
    "created_by": 339,
    "created_on": 1729723553,
    "updated_by": 729,
    "updated_on": 1738516939,
    "estimate": null,
    "estimate_forecast": null,
    "suite_id": 926,
    "display_order": 30,
    "is_deleted": 0,
    "case_assignedto_id": null,
    "custom_automation_type": 0,
    "custom_automatable": 1,
    "custom_automated": 0,
    "custom_deprecatedtestcase": false,
    "custom_ui_case": 1,
    "custom_automation_id": null,
    "custom_hack_functional_sub_categories": 1,
    "custom_hack_test_categories": 5,
    "custom_hack_jira_escalated": false,
    "custom_appliance_support": 2,
    "custom_sub_component": 50,
    "custom_testrail_bdd_scenario": null,
    "custom_summary": null,
    "custom_preconds": null,
    "custom_steps": "- Setup primary nexthop as host=invalid-nexthop.co to simulate DNS failure error \n- Setup secondary nexthop as valid host and port\n- Validate service tries to perform DNS check on first host once and then try to second host to perform DNS and TCP connection. \n- Validate email go through correctly and no failure\n- Review smtpreq 3 smtp 3 logs",
    "custom_expected": "Before any implemetation chnages, DNS Failure to Back connection domain currently make 2 attempts. Discuss with Khurram Saqlain on any changes expected? Answered based updated design doc.\n\n2024-10-17 22:50:09         WARN        smtpproxy-b779755d7-gn4nh        12           SMTPREQ 56:     SmtpRequestEngine.cpp:01366 trid=2954409123602509056 rqid=2954409123602509057 tenantid=1047 user='test1@yhsa.r.com' DNS failure: host index=0; attempt=0; failed host=invalid-nexthop.co; will attempt another host if configured; set the state to: SMTP_PERFORM_DNS; messageId=[<20241017224917.GA2695773@smtp-proxy-jenkins.hippo.sje011.netskope.com>]\n2024-10-17 22:50:09         WARN        smtpproxy-b779755d7-gn4nh        12           SMTPREQ 56:     SmtpRequestEngine.cpp:01410 trid=2954409123602509056 rqid=2954409123602509057 tenantid=1047 user='test1@yhsa.r.com' DNS failure: reset next hop to retry; dns attempt index=1\n2024-10-17 22:50:09         WARN        smtpproxy-b779755d7-gn4nh        12           SMTPREQ 56:     SmtpRequestEngine.cpp:01366 trid=2954409123602509056 rqid=2954409123602509057 tenantid=1047 user='test1@yhsa.r.com' DNS failure: host index=0; attempt=1; failed host=invalid-nexthop.co; will attempt another host if configured; set the state to: SMTP_PERFORM_DNS; messageId=[<20241017224917.GA2695773@smtp-proxy-jenkins.hippo.sje011.netskope.com>]\n2024-10-17 22:50:09        ERROR        smtpproxy-b779755d7-gn4nh        12           SMTPREQ 56:     SmtpRequestEngine.cpp:01427 trid=2954409123602509056 rqid=2954409123602509057 tenantid=1047 user='test1@yhsa.r.com' DNS failure: unable to find a valid next hop to use; teardown; src-ip=70.42.129.126; number of retry attempts=1\n2024-10-17 22:50:09         WARN        smtpproxy-b779755d7-gn4nh        12              SMTP 56: AppModuleSmtpMtaProxy.cpp:00472 trid=2954409123602509056 rqid=2954409123602509057 tenantid=1047 user='test1@yhsa.r.com' Send error to front due to back error; back host=invalid-nexthop.co:30; error string=421 Network error\n\nWith new feature flag enabled expected behavior:\n\nservice tries to perform DNS check on first host once and then try to second host to perform DNS and TCP connection. \n\n\n- Validate email go through correctly and no failure\n- Review smtpreq 3 smtp 3 logs",
    "custom_steps_separated": null,
    "custom_mission": null,
    "custom_goals": null,
    "comments": [],
    "custom_keyword": [],
    "custom_stack_label": [
        4
    ]
}