{
    "updated_cases": [
        {
            "id": 1535991,
            "title": "Verify Dynamic Trust store certificates are scanned when the purge timer is expired",
            "section_id": 105367,
            "template_id": 1,
            "type_id": 6,
            "priority_id": 2,
            "milestone_id": null,
            "refs": null,
            "created_by": 350,
            "created_on": 1682328487,
            "updated_by": 729,
            "updated_on": 1736855969,
            "estimate": null,
            "estimate_forecast": null,
            "suite_id": 921,
            "display_order": 17,
            "is_deleted": 0,
            "case_assignedto_id": null,
            "custom_automation_type": 0,
            "custom_automatable": 1,
            "custom_automated": 1,
            "custom_deprecatedtestcase": false,
            "custom_ui_case": 1,
            "custom_automation_id": null,
            "custom_hack_functional_sub_categories": 1,
            "custom_hack_test_categories": 3,
            "custom_hack_jira_escalated": false,
            "custom_appliance_support": null,
            "custom_sub_component": 48,
            "custom_testrail_bdd_scenario": null,
            "custom_summary": null,
            "custom_preconds": null,
            "custom_steps": "1. Update stagged_config with \n\n\"TTL\" : 3600 seconds (1 hour)\n\"purge-timer\" : 60 seconds\n\"expire-limit\" : 0 seconds \n2. Set up a intermediate certificate validity to 60 sec (1 min) on test server\n3. Establish SSL connection from proxy to server.\n4. SSL connection is successful and certificate is stored in dynamic trust store.\n5. Wait for 61 sec (more than the purge-timer and the certificate is also expired by then)\n6. Verify downloaded intermediate certificate is purged\n7. Re-establish SSL handshake from proxy to server\n8. Verify that the Dynamic Trusted Store the refreshed intermediate CA and SSL handshake is successful.",
            "custom_expected": "Intermediate cert stores in Dynamic trust store should be purged after the purge timer.\n\nProxy should download the intermediate CA after purging and SSL handshake is successful.",
            "custom_steps_separated": null,
            "custom_mission": null,
            "custom_goals": null,
            "comments": [],
            "custom_keyword": [],
            "custom_stack_label": []
        },
        {
            "id": 1535992,
            "title": "Verify SSL handshake failure with cert in excluded list",
            "section_id": 105367,
            "template_id": 1,
            "type_id": 6,
            "priority_id": 2,
            "milestone_id": null,
            "refs": null,
            "created_by": 350,
            "created_on": 1682328487,
            "updated_by": 729,
            "updated_on": 1736855969,
            "estimate": null,
            "estimate_forecast": null,
            "suite_id": 921,
            "display_order": 18,
            "is_deleted": 0,
            "case_assignedto_id": null,
            "custom_automation_type": 0,
            "custom_automatable": 1,
            "custom_automated": 1,
            "custom_deprecatedtestcase": false,
            "custom_ui_case": 1,
            "custom_automation_id": null,
            "custom_hack_functional_sub_categories": 1,
            "custom_hack_test_categories": 3,
            "custom_hack_jira_escalated": false,
            "custom_appliance_support": null,
            "custom_sub_component": 48,
            "custom_testrail_bdd_scenario": null,
            "custom_summary": null,
            "custom_preconds": null,
            "custom_steps": "1. Add intermediate cert to excluded-list in stagged_config.json \n\n\"TTL\" : 60 seconds\n\"purge-timer\" : 60 seconds\n\"expire-limit\" : 86400 seconds (1 day)\n\"excluded-certs\":[{\"subject\": \"/C=US/O=DigiCert Inc/OU=www.digicert.com/CN=RapidSSL TLS RSA CA G1\",\n\"serial-number\": \"0B259422CED9812A15A04E99528A0EFA\"}]\n2. Send traffic to briocola.tn\n3. Establish SSL connection from proxy to server \n4. Verify that SSL handshake fails due to intermediate cert in excluded list",
            "custom_expected": "SSL handshake should fail due to certificate present in excluded list",
            "custom_steps_separated": null,
            "custom_mission": null,
            "custom_goals": null,
            "comments": [],
            "custom_keyword": [],
            "custom_stack_label": []
        },
        {
            "id": 1535993,
            "title": "Verify SSL handshake failure with cert in excluded list after a wait time with intermediate certificate already present in the trust store",
            "section_id": 105367,
            "template_id": 1,
            "type_id": 6,
            "priority_id": 2,
            "milestone_id": null,
            "refs": null,
            "created_by": 350,
            "created_on": 1682328487,
            "updated_by": 729,
            "updated_on": 1736855969,
            "estimate": null,
            "estimate_forecast": null,
            "suite_id": 921,
            "display_order": 19,
            "is_deleted": 0,
            "case_assignedto_id": null,
            "custom_automation_type": 0,
            "custom_automatable": 1,
            "custom_automated": 1,
            "custom_deprecatedtestcase": false,
            "custom_ui_case": 1,
            "custom_automation_id": null,
            "custom_hack_functional_sub_categories": 1,
            "custom_hack_test_categories": 3,
            "custom_hack_jira_escalated": false,
            "custom_appliance_support": null,
            "custom_sub_component": 48,
            "custom_testrail_bdd_scenario": null,
            "custom_summary": null,
            "custom_preconds": null,
            "custom_steps": "Send traffic to briocola.tn \n\nProxy establishes a connection to above site and stores the intermediate cert\n\nAdd the intermediate cert from above site to excluded-list in stagged_config.json \n\n\"TTL\" : 60 seconds\n\"purge-timer\" : 60 seconds\n\"expire-limit\" : 86400 seconds (1 day)\n\"excluded-certs\":[{\"subject\": \"/C=US/O=DigiCert Inc/OU=www.digicert.com/CN=RapidSSL TLS RSA CA G1\",\n\"serial-number\": \"0B259422CED9812A15A04E99528A0EFA\"}]\n\nWait for 61 second for proxy to purge the certificate( i.e 60 sec TTL time)\n\nSend traffic to briocola.tn\n\nVerify that SSL handshake fails due to excluded certificate and certs not present in dynamic trust store\n\nVerify the proper message in the log for SSL handshake failure",
            "custom_expected": "Certificate should be purged after 61 second\n\nSSL handshake should fail due to certificate present in excluded list \n\nVerify the proxy log for SSL handshake failure",
            "custom_steps_separated": null,
            "custom_mission": null,
            "custom_goals": null,
            "comments": [],
            "custom_keyword": [],
            "custom_stack_label": []
        },
        {
            "id": 1535994,
            "title": "Verify SSL handshake failure with two certs in excluded list",
            "section_id": 105367,
            "template_id": 1,
            "type_id": 6,
            "priority_id": 2,
            "milestone_id": null,
            "refs": null,
            "created_by": 350,
            "created_on": 1682328487,
            "updated_by": 729,
            "updated_on": 1736855969,
            "estimate": null,
            "estimate_forecast": null,
            "suite_id": 921,
            "display_order": 20,
            "is_deleted": 0,
            "case_assignedto_id": null,
            "custom_automation_type": 0,
            "custom_automatable": 1,
            "custom_automated": 1,
            "custom_deprecatedtestcase": false,
            "custom_ui_case": 1,
            "custom_automation_id": null,
            "custom_hack_functional_sub_categories": 1,
            "custom_hack_test_categories": 3,
            "custom_hack_jira_escalated": false,
            "custom_appliance_support": null,
            "custom_sub_component": 48,
            "custom_testrail_bdd_scenario": null,
            "custom_summary": null,
            "custom_preconds": null,
            "custom_steps": "Add cert to excluded-list in stagged_config.json \n\n\"TTL\" : 3600 seconds (1 hours)\n\"purge-timer\": 60 seconds\n\"expire-limit\" : 86400 seconds (1 day)\n\"excluded-certs\":\n[{\"subject\": \"/C=CN/O=TrustAsia Technologies, Inc./CN=TrustAsia RSA DV TLS CA G2\", \n\"serial-number\": \"B20CED552E31A0BF343A7528743BE9AB\"},\n{\"subject\": \"/C=US/O=DigiCert Inc/OU=www.digicert.com/CN=RapidSSL TLS RSA CA G1\"\",\n\"serial-number\": \"0B259422CED9812A15A04E99528A0EFA\"}]\nSend traffic to briocola.tn and www.globalso.site\n\nEstablish SSL connection from proxy to server\n\nVerify that SSL handshake fails for both the sites due to certs added in excluded list\n\nVerify the proper message in the log for SSL handshake failure",
            "custom_expected": "SSL handshake for both the sites should fail due to certificate present in excluded list",
            "custom_steps_separated": null,
            "custom_mission": null,
            "custom_goals": null,
            "comments": [],
            "custom_keyword": [],
            "custom_stack_label": []
        },
        {
            "id": 1535995,
            "title": "Verify SSL handshake failure with two certs in excluded list with same subject name",
            "section_id": 105367,
            "template_id": 1,
            "type_id": 6,
            "priority_id": 2,
            "milestone_id": null,
            "refs": null,
            "created_by": 350,
            "created_on": 1682328487,
            "updated_by": 729,
            "updated_on": 1736855969,
            "estimate": null,
            "estimate_forecast": null,
            "suite_id": 921,
            "display_order": 21,
            "is_deleted": 0,
            "case_assignedto_id": null,
            "custom_automation_type": 0,
            "custom_automatable": 1,
            "custom_automated": 1,
            "custom_deprecatedtestcase": false,
            "custom_ui_case": 1,
            "custom_automation_id": null,
            "custom_hack_functional_sub_categories": 1,
            "custom_hack_test_categories": 3,
            "custom_hack_jira_escalated": false,
            "custom_appliance_support": null,
            "custom_sub_component": 48,
            "custom_testrail_bdd_scenario": null,
            "custom_summary": null,
            "custom_preconds": null,
            "custom_steps": "1. Create intermediate cert on the test server\n2. Get the serial number or subject from above and add it to the staged_config excluded list\n\n\"excluded-certs\":[{\"subject\": \"/C=US/ST= Santa Clara/O=Netskope Inc, Inc./CN=Netskope Inter CA\", \n\"serial-number\": \"123455\"}]\n\n3. Send traffic to test server\n4. Establish SSL connection from proxy to server\n5. Verify that SSL handshake fails due to excluded certificate\n6. Create intermediate cert again on the test server\n7. Get the serial number or subject from above and update it to the staged_config excluded list\n\n\"excluded-certs\":[{\"subject\": \"/C=US/ST= Santa Clara/O=Netskope Inc, Inc./CN=Netskope Inter CA\", \n\"serial-number\": \"123455\"},\n\"subject\": \"C=US/ST= Santa Clara/O=Netskope Inc, Inc./CN=Netskope Inter CA\", \n\"serial-number\": \"E99528A0EFA1234\"}]\n\n8. Repeat step 3 - 6",
            "custom_expected": "SSL handshake should fail for both traffics which has the same subject name and different serrial number",
            "custom_steps_separated": null,
            "custom_mission": null,
            "custom_goals": null,
            "comments": [],
            "custom_keyword": [],
            "custom_stack_label": []
        },
        {
            "id": 1535996,
            "title": "Verify SSL handshake failure with excluded-sni",
            "section_id": 105367,
            "template_id": 1,
            "type_id": 6,
            "priority_id": 2,
            "milestone_id": null,
            "refs": null,
            "created_by": 350,
            "created_on": 1682328487,
            "updated_by": 729,
            "updated_on": 1736855969,
            "estimate": null,
            "estimate_forecast": null,
            "suite_id": 921,
            "display_order": 22,
            "is_deleted": 0,
            "case_assignedto_id": null,
            "custom_automation_type": 0,
            "custom_automatable": 1,
            "custom_automated": 1,
            "custom_deprecatedtestcase": false,
            "custom_ui_case": 1,
            "custom_automation_id": null,
            "custom_hack_functional_sub_categories": 1,
            "custom_hack_test_categories": 3,
            "custom_hack_jira_escalated": false,
            "custom_appliance_support": null,
            "custom_sub_component": 48,
            "custom_testrail_bdd_scenario": null,
            "custom_summary": null,
            "custom_preconds": null,
            "custom_steps": "1. Add cert to excluded-list in stagged_config.json \"TTL\" : 3600 seconds (1 hours)\n\n\"purge-timer\": 60 seconds\n\"expire-limit\" : 86400 seconds (1 day)\n\"excluded-certs\":[]\n\"excluded-sni\" : [<incomplete chain site>]\nEstablish SSL connection using SNI: <incomplete chain site>\n\n2. Verify proxy doesnot download intermediate cert and SSL handshake fails",
            "custom_expected": "SSL handshake should fail due to sni in excluded list",
            "custom_steps_separated": null,
            "custom_mission": null,
            "custom_goals": null,
            "comments": [],
            "custom_keyword": [],
            "custom_stack_label": []
        },
        {
            "id": 1535997,
            "title": "Verify SSL connection with self-signed certificate",
            "section_id": 105367,
            "template_id": 1,
            "type_id": 6,
            "priority_id": 2,
            "milestone_id": null,
            "refs": null,
            "created_by": 350,
            "created_on": 1682328487,
            "updated_by": 729,
            "updated_on": 1736855969,
            "estimate": null,
            "estimate_forecast": null,
            "suite_id": 921,
            "display_order": 23,
            "is_deleted": 0,
            "case_assignedto_id": null,
            "custom_automation_type": 0,
            "custom_automatable": 1,
            "custom_automated": 1,
            "custom_deprecatedtestcase": false,
            "custom_ui_case": 1,
            "custom_automation_id": null,
            "custom_hack_functional_sub_categories": 1,
            "custom_hack_test_categories": 3,
            "custom_hack_jira_escalated": false,
            "custom_appliance_support": null,
            "custom_sub_component": 48,
            "custom_testrail_bdd_scenario": null,
            "custom_summary": null,
            "custom_preconds": null,
            "custom_steps": "1. Set up a test server with a self-signed certificate\n2. Attempt to establish SSL connection from proxy to server\n3. Verify that SSL handshake fails due to self-signed certificate with proper error",
            "custom_expected": "SSL handshake fails due to self-signed certificate with proper error",
            "custom_steps_separated": null,
            "custom_mission": null,
            "custom_goals": null,
            "comments": [],
            "custom_keyword": [],
            "custom_stack_label": []
        },
        {
            "id": 1535998,
            "title": "Verify SSL connection with invalid CA constraint",
            "section_id": 105367,
            "template_id": 1,
            "type_id": 6,
            "priority_id": 2,
            "milestone_id": null,
            "refs": null,
            "created_by": 350,
            "created_on": 1682328487,
            "updated_by": 729,
            "updated_on": 1736855969,
            "estimate": null,
            "estimate_forecast": null,
            "suite_id": 921,
            "display_order": 24,
            "is_deleted": 0,
            "case_assignedto_id": null,
            "custom_automation_type": 0,
            "custom_automatable": 1,
            "custom_automated": 1,
            "custom_deprecatedtestcase": false,
            "custom_ui_case": 1,
            "custom_automation_id": null,
            "custom_hack_functional_sub_categories": 1,
            "custom_hack_test_categories": 3,
            "custom_hack_jira_escalated": false,
            "custom_appliance_support": null,
            "custom_sub_component": 48,
            "custom_testrail_bdd_scenario": null,
            "custom_summary": null,
            "custom_preconds": null,
            "custom_steps": "1. Set up a test server with a certificate that has an invalid CA constraint\n2. Attempt to establish SSL connection from proxy to server\n3. Verify that SSL handshake fails due to invalid CA constraint",
            "custom_expected": "SSL handshake fails due to invalid CA constraint with proper error",
            "custom_steps_separated": null,
            "custom_mission": null,
            "custom_goals": null,
            "comments": [],
            "custom_keyword": [],
            "custom_stack_label": []
        },
        {
            "id": 1535999,
            "title": "Verify SSL connection with invalid issuer (proxy doesn't trust root ca)",
            "section_id": 105367,
            "template_id": 1,
            "type_id": 6,
            "priority_id": 2,
            "milestone_id": null,
            "refs": null,
            "created_by": 350,
            "created_on": 1682328487,
            "updated_by": 729,
            "updated_on": 1736855969,
            "estimate": null,
            "estimate_forecast": null,
            "suite_id": 921,
            "display_order": 25,
            "is_deleted": 0,
            "case_assignedto_id": null,
            "custom_automation_type": 0,
            "custom_automatable": 1,
            "custom_automated": 1,
            "custom_deprecatedtestcase": false,
            "custom_ui_case": 1,
            "custom_automation_id": null,
            "custom_hack_functional_sub_categories": 1,
            "custom_hack_test_categories": 3,
            "custom_hack_jira_escalated": false,
            "custom_appliance_support": null,
            "custom_sub_component": 48,
            "custom_testrail_bdd_scenario": null,
            "custom_summary": null,
            "custom_preconds": null,
            "custom_steps": "1. Set up a test server with a certificate which is not trusted on the proxy\n2. Attempt to establish SSL connection from proxy to server\n3. Verify that SSL handshake fails due to invalid issuer",
            "custom_expected": "SSL handshake fails due to invalid issuer with proper error",
            "custom_steps_separated": null,
            "custom_mission": null,
            "custom_goals": null,
            "comments": [],
            "custom_keyword": [],
            "custom_stack_label": []
        },
        {
            "id": 1536000,
            "title": "Verify SSL connection with HTTP error during certificate download",
            "section_id": 105367,
            "template_id": 1,
            "type_id": 6,
            "priority_id": 2,
            "milestone_id": null,
            "refs": null,
            "created_by": 350,
            "created_on": 1682328487,
            "updated_by": 729,
            "updated_on": 1736855969,
            "estimate": null,
            "estimate_forecast": null,
            "suite_id": 921,
            "display_order": 26,
            "is_deleted": 0,
            "case_assignedto_id": null,
            "custom_automation_type": 0,
            "custom_automatable": 0,
            "custom_automated": 0,
            "custom_deprecatedtestcase": null,
            "custom_ui_case": 1,
            "custom_automation_id": null,
            "custom_hack_functional_sub_categories": 1,
            "custom_hack_test_categories": 3,
            "custom_hack_jira_escalated": null,
            "custom_appliance_support": null,
            "custom_sub_component": 48,
            "custom_testrail_bdd_scenario": null,
            "custom_summary": null,
            "custom_preconds": null,
            "custom_steps": "1. Set up a test server with a complete certificate chain (root CA, intermediate CA, server certificate)\r\n2. Introduce an HTTP error on the HTTP server which is serving the intermediate cert\r\n3. Attempt to establish SSL connection from proxy to server\r\n4. Verify that SSL handshake fails due to HTTP error",
            "custom_expected": "SSL handshake fails due to HTTP error in downloading the intermediate certificate",
            "custom_steps_separated": null,
            "custom_mission": null,
            "custom_goals": null,
            "comments": [],
            "custom_keyword": [],
            "custom_stack_label": []
        }
    ]
}